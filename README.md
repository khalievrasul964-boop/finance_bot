# 💰 Finance Bot - Личный финансовый ассистент

Интеллектуальный Telegram-бот для отслеживания доходов и расходов с поддержкой категоризации и подробными отчетами.

## 🚀 Возможности

✅ **Добавление операций** - Доходы и расходы с указанием времени  
✅ **Категории** - 10 типов расходов и 7 типов доходов  
✅ **Отчеты с временем** - День/неделя/месяц с указанием времени каждой операции  
✅ **Финансовый дневник** - Автоматическое сохранение всех операций  
✅ **Удаление операций** - Отмена последней транзакции командой `/undo`  
✅ **Анализ расходов** - Сумма по способам платежа (наличные/карта)

## 📊 Пример отчета

```
📅 19.02.2026 (Пт)

┌────────────────────────────────────────────────────┐
│ Время │  Сумма   │    Категория    │ Способ     │
├────────────────────────────────────────────────────┤
│ 🟢 09:00 │  50000.00 ₽ │ 💼 Зарплата    │ 💳 Карта   │
│ 🔴 12:30 │    450.00 ₽ │ 🍔 Еда         │ 💵 Нал.    │
│ 🔴 14:00 │    250.00 ₽ │ 🚗 Транспорт   │ 💳 Карта   │
├────────────────────────────────────────────────────┤
│ 🟢 БАЛАНС:              49300.00 ₽ │
└────────────────────────────────────────────────────┘
```

## 🛠 Установка

```bash
# Клонируем репозиторий
git clone <repo>
cd finance_bot

# Создаем виртуальное окружение
python -m venv venv

# Активируем (Windows)
& venv\Scripts\Activate.ps1

# Установка зависимостей
pip install -r requirements.txt

# Создаем .env файл и добавляем токен
# BOT_TOKEN=ваш_токен_от_telegram
```

## 🎯 Команды бота

| Команда | Описание |
|---------|----------|
| `/start` | Регистрация / главное меню |
| `/help` | Справка по всем функциям |
| `/undo` | Отменить последнюю операцию |
| `📥 Доход` | Добавить доход |
| `📤 Расход` | Добавить расход |
| `📊 Сегодня` | Отчет за день с временем операций |
| `📆 Неделя` | Отчет за неделю с временем |
| `🗓 Месяц` | Отчет за месяц с временем |

## 📁 Структура файлов

```
finance_bot/
├── main.py                    # Точка входа
├── config/
│   └── settings.py           # Конфигурация
├── database/
│   └── db.py                 # База данных
├── handlers/
│   ├── start.py             # Регистрация и команды
│   ├── income.py            # Добавление доходов
│   ├── expense.py           # Добавление расходов
│   └── reports.py           # Отчеты
├── services/
│   ├── user_service.py      # Работа с пользователями
│   ├── transaction_service.py # Работа с операциями
│   └── report_service.py    # Генерация отчетов
├── utils/
│   ├── keyboards.py         # Клавиатуры
│   ├── validators.py        # Валидация
│   └── report_formatter.py  # Форматирование отчетов
├── storage/
│   └── journal.py          # Сохранение в дневник
└── users_data/
    └── [имя_пользователя].txt   # Финансовый дневник
```

## 💾 База данных

### Таблица users
```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    telegram_id INTEGER UNIQUE NOT NULL,
    name TEXT NOT NULL,
    timezone TEXT DEFAULT 'UTC',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### Таблица transactions
```sql
CREATE TABLE transactions (
    id INTEGER PRIMARY KEY,
    user_id INTEGER NOT NULL,
    amount REAL NOT NULL,
    type TEXT CHECK(type IN ('income', 'expense')) NOT NULL,
    method TEXT CHECK(method IN ('cash', 'card')) NOT NULL,
    category TEXT DEFAULT 'Другое',
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY(user_id) REFERENCES users(id)
);
```

## 🎨 Категории

### Расходы
🍔 Еда, 🚗 Транспорт, 🏠 Жилье, 💻 Техника, 👗 Одежда, 📚 Образование, 🏋️ Спорт, 🎬 Развлечения, 💊 Здоровье, 🛒 Покупки

### Доходы
💼 Зарплата, 🎁 Подарок, 📈 Инвестиции, 💰 Бонус, 🏪 Фриланс, 📦 Продажа, 🏷 Другое

## ⏱️ Сохранение времени

**Каждая операция автоматически сохраняет:**
- ✅ Дату и точное время (часы и минуты)
- ✅ Сумму
- ✅ Категорию
- ✅ Способ платежа (наличные/карта)

**Время отображается:**
- 📊 В отчетах (день/неделя/месяц)
- 📝 В финансовом дневнике (файлы users_data/)
- 📋 Сортировка по времени внутри дня

## 📝 Пример дневника

```
# 📒 Финансовый дневник — Иван Петров

🟢 2026-02-19 09:00 | 50000.00 ₽ | карта | 💼 Зарплата
🔴 2026-02-19 12:30 | 450.00 ₽ | наличные | 🍔 Еда
🔴 2026-02-19 14:00 | 250.00 ₽ | карта | 🚗 Транспорт
🔴 2026-02-19 19:00 | 50.00 ₽ | наличные | 🎬 Развлечения
```

## 🔒 Безопасность

- ✅ Валидация всех входных данных
- ✅ Обработка ошибок с информативными сообщениями
- ✅ Логирование всех операций
- ✅ Защита от некорректных сумм (0.01 - 10,000,000 ₽)

## 🚀 Запуск

```bash
python main.py
```

Бот будет запущен и готов к использованию!

## 📱 Требования

- Python 3.8+
- aiogram 3.10.0
- aiosqlite 0.20.0
- python-dotenv 1.0.1

## 📄 Лицензия

MIT License

---

**Версия:** 3.0 (с сохранением времени операций)  
**Дата обновления:** Февраль 2026

## 🚀 Деплой (быстрый путь)

Ниже простые шаги, чтобы быстро запустить бота в облаке (Railway / Render). Всё просто и без сервера.

- 1) Подготовка
    - Создайте файл `.env` на локальной машине, скопировав `.env.example` и вставьте ваш `BOT_TOKEN`.

- 2) Git и GitHub
    - Инициализируйте git и запушьте репозиторий на GitHub:

```bash
git init
git add .
git commit -m "Initial commit"
# Создайте репозиторий на GitHub и затем:
git remote add origin https://github.com/<your-username>/<repo>.git
git branch -M main
git push -u origin main
```

- 3) Railway (рекомендуется для быстрого старта)
    - Зайдите на https://railway.app и подключите GitHub.
    - Создайте новый проект → Deploy from GitHub → выберите этот репозиторий.
    - В разделе Environment добавьте `BOT_TOKEN` (значение из вашего `.env`).
    - Start Command: `python main.py` (или другой стартовый файл, если в проекте отличается).
    - Нажмите Deploy и откройте логи — бот должен подключиться к Telegram.

- 4) Docker (альтернатива для VPS)
    - В репозитории есть `Dockerfile`. На VPS соберите образ и запустите контейнер:

```bash
docker build -t finance-bot:latest .
docker run -d --restart unless-stopped --env-file .env -p 8000:8000 --name finance-bot finance-bot:latest
```

- 5) 24/7 работа
    - Railway/Render: включите опцию "always on" или выберите платный план.
    - На VPS: используйте `--restart unless-stopped` или systemd/unit для автозапуска.

---

Если хотите — могу автоматически создать git, добавить `.gitignore` и сделать первый коммит в вашем рабочем каталоге, а также подготовить инструкцию по деплою с шагами конкретно для Railway. Скажите, какие действия сделать сейчас.
